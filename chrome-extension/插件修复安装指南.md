# Amazon产品信息提取器 - 插件修复安装指南

## 问题修复说明

本次修复解决了以下问题：
1. **连接失败问题** - 优化了content script注入机制
2. **域名支持问题** - 增加了对所有Amazon域名的支持
3. **初始化问题** - 改进了插件初始化和重试机制
4. **权限问题** - 添加了必要的scripting权限

## 安装步骤

### 1. 完全卸载旧版本（重要！）
1. 打开Chrome浏览器
2. 进入 `chrome://extensions/`
3. 找到"Amazon产品信息提取器"
4. 点击"移除"按钮
5. **重启Chrome浏览器**（重要步骤）

### 2. 安装新版本
1. 重启Chrome后，进入 `chrome://extensions/`
2. 打开右上角的"开发者模式"开关
3. 点击"加载已解压的扩展程序"
4. 选择包含修复文件的 `chrome-extension` 文件夹
5. 确认安装

### 3. 验证安装
1. 在扩展程序页面确认插件已启用
2. 插件图标应该出现在浏览器工具栏中
3. 版本号应显示为 2.0.1
4. 点击插件详情，确认所有权限已授予

### 4. 测试插件（推荐）
1. 访问任意Amazon产品页面
2. 打开浏览器开发者工具（F12）
3. 在Console标签页中粘贴并运行测试脚本：
```javascript
// 复制chrome-extension/test-plugin.js的内容到控制台运行
```

## 使用说明

### 基本使用流程
1. **访问Amazon产品页面**
   - 支持所有Amazon域名（.com, .cn, .co.uk, .de, .fr等）
   - 确保在产品详情页面（URL包含/dp/）

2. **提取产品信息**
   - 点击浏览器工具栏中的插件图标
   - 点击"提取产品信息"按钮
   - 等待提取完成

3. **使用复制功能**
   - 复制标题：单独复制产品标题
   - 复制五点描述：复制产品的五点描述
   - 复制产品信息：复制重量、尺寸、ASIN、链接、价格
   - 一键复制全部：复制所有信息

4. **打开利润计算器**
   - 提取信息后点击"打开利润计算器"
   - 自动跳转到计算器页面并填充数据

## 故障排除

### 如果仍然出现"无法连接到页面脚本"错误：

#### 方法1: 完整重置插件
1. **完全卸载插件**
   - 进入 `chrome://extensions/`
   - 移除插件
   - **重启Chrome浏览器**

2. **清理浏览器缓存**
   - 按 Ctrl+Shift+Delete
   - 选择"缓存的图片和文件"
   - 点击"清除数据"

3. **重新安装插件**
   - 按照上述安装步骤重新安装

#### 方法2: 手动注入脚本
1. 在Amazon产品页面打开开发者工具（F12）
2. 切换到Console标签页
3. 粘贴以下代码并回车：
```javascript
// 手动加载content script
const script = document.createElement('script');
script.src = chrome.runtime.getURL('content.js');
document.head.appendChild(script);
```

#### 方法3: 检查页面兼容性
1. **确保在正确的页面**
   - 必须是Amazon产品详情页面
   - URL包含 `/dp/` 或 `/gp/product/`
   - 不能是搜索结果页或首页

2. **检查页面加载状态**
   - 等待页面完全加载
   - 滚动页面查看所有内容
   - 确保没有网络错误

3. **尝试不同的Amazon域名**
   - amazon.com (美国)
   - amazon.cn (中国) 
   - amazon.co.uk (英国)

#### 方法4: 浏览器设置检查
1. **检查扩展权限**
   - 进入 `chrome://extensions/`
   - 点击插件的"详情"
   - 确认"在所有网站上读取和更改数据"已启用

2. **检查网站权限**
   - 在Amazon页面点击地址栏左侧的锁图标
   - 确认没有阻止JavaScript或扩展程序

3. **禁用其他扩展**
   - 临时禁用其他可能冲突的扩展
   - 特别是广告拦截器和隐私保护扩展

### 常见错误信息及解决方案：

- **"请在Amazon产品页面使用此扩展"**
  - 确保在正确的Amazon域名和产品页面

- **"插件初始化失败，请刷新页面后重试"**
  - 刷新当前页面
  - 重新点击插件

- **"无法连接到页面脚本"**
  - 检查插件是否正确安装
  - 重新加载插件

- **"未找到产品信息"**
  - 确保页面完全加载
  - 尝试滚动页面查看更多内容

## 技术改进详情

### 1. Manifest V3 优化
- 添加了 `scripting` 权限
- 支持动态脚本注入
- 改进了权限管理

### 2. 连接机制改进
- 添加了连接测试功能
- 实现了自动脚本注入
- 优化了重试机制

### 3. 域名支持扩展
支持的Amazon域名：
- amazon.com (美国)
- amazon.cn (中国)
- amazon.co.uk (英国)
- amazon.de (德国)
- amazon.fr (法国)
- amazon.it (意大利)
- amazon.es (西班牙)
- amazon.ca (加拿大)
- amazon.com.au (澳大利亚)
- amazon.co.jp (日本)
- amazon.in (印度)

### 4. 错误处理优化
- 更友好的错误提示
- 自动重试机制
- 详细的调试日志

## 联系支持

如果问题仍然存在，请：
1. 打开浏览器开发者工具（F12）
2. 查看Console标签页的错误信息
3. 截图错误信息并联系技术支持

---

**版本**: 2.0.1  
**更新日期**: 2025年9月10日  
**兼容性**: Chrome 88+, Edge 88+